---
import { getImage } from 'astro:assets'

const { img } = Astro.props

function calcHeight(width) {
  return (width / img.width) * img.height
}

const splash = {
  xl: await getImage({ src: img, width: '1280px', height: `${calcHeight(1280)}px` }),
  lg: await getImage({ src: img, width: '1024px', height: `${calcHeight(1024)}px` }),
  md: await getImage({ src: img, width: '768px', height: `${calcHeight(768)}px` }),
  sm: await getImage({ src: img, width: '640px', height: `${calcHeight(640)}px` })
}
---

<picture>
  <source media="(max-width: 640px)" srcset={splash.sm.src} />
  <source media="(max-width: 768px)" srcset={splash.md.src} />
  <source media="(max-width: 1024px)" srcset={splash.lg.src} />
  <img src={splash.xl.src} alt={Astro.props.alt} />
</picture>